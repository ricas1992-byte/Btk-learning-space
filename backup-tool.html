<!DOCTYPE html>
<html dir="rtl" lang="he">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>×›×œ×™ ×’×™×‘×•×™ - BTK Learning Space</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #1e3a8a;
            text-align: center;
        }
        .section {
            margin: 30px 0;
            padding: 20px;
            background: #f9fafb;
            border-radius: 8px;
        }
        button {
            background: #d4af37;
            color: #1e3a8a;
            border: none;
            padding: 12px 24px;
            font-size: 16px;
            font-weight: bold;
            border-radius: 6px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #b8933a;
        }
        .success {
            color: #059669;
            padding: 10px;
            background: #d1fae5;
            border-radius: 4px;
            margin: 10px 0;
            display: none;
        }
        .info {
            color: #1e40af;
            padding: 10px;
            background: #dbeafe;
            border-radius: 4px;
            margin: 10px 0;
        }
        textarea {
            width: 100%;
            min-height: 150px;
            padding: 10px;
            border: 2px solid #d1d5db;
            border-radius: 4px;
            font-family: monospace;
            font-size: 12px;
        }
        input[type="file"] {
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ›¡ï¸ ×›×œ×™ ×’×™×‘×•×™ ×•×©å¾©×™×—×–×•×¨ - BTK Learning Space</h1>

        <!-- ×™×™×¦×•× -->
        <div class="section">
            <h2>ğŸ“¤ ×™×™×¦×•× ×§×•×¨×¡×™× (Backup)</h2>
            <div class="info">
                <strong>×”×•×¨××•×ª:</strong> ×œ×—×¥ ×¢×œ ×”×›×¤×ª×•×¨ ×›×“×™ ×œ×™×™×¦× ××ª ×›×œ ×”×§×•×¨×¡×™× ×©×œ×š ×œ×§×•×‘×¥ JSON.
            </div>
            <button onclick="exportCourses()">×™×™×¦× ××ª ×›×œ ×”×§×•×¨×¡×™×</button>
            <div id="exportSuccess" class="success">âœ… ×”×§×•×¨×¡×™× ×™×•×¦××• ×‘×”×¦×œ×—×”!</div>
        </div>

        <!-- ×™×™×‘×•× -->
        <div class="section">
            <h2>ğŸ“¥ ×™×™×‘×•× ×§×•×¨×¡×™× (Restore)</h2>
            <div class="info">
                <strong>×”×•×¨××•×ª:</strong> ×‘×—×¨ ××ª ×§×•×‘×¥ ×”-JSON ×©×™×™×¦××ª ×§×•×“×.
                <br><strong>âš ï¸ ××–×”×¨×”:</strong> ×¤×¢×•×œ×” ×–×• ×ª×“×¨×•×¡ ××ª ×›×œ ×”×§×•×¨×¡×™× ×”×§×™×™××™×!
            </div>
            <input type="file" id="fileInput" accept=".json" onchange="importCourses(event)">
            <div id="importSuccess" class="success"></div>
        </div>

        <!-- ×¦×¤×™×™×” ×‘× ×ª×•× ×™× -->
        <div class="section">
            <h2>ğŸ‘ï¸ ×¦×¤×™×™×” ×‘× ×ª×•× ×™×</h2>
            <div class="info">
                ×œ×—×¥ ×›×“×™ ×œ×¨××•×ª ××ª ×”× ×ª×•× ×™× ×”× ×•×›×—×™×™× ×‘-localStorage
            </div>
            <button onclick="viewData()">×”×¦×’ × ×ª×•× ×™×</button>
            <textarea id="dataView" placeholder="×”× ×ª×•× ×™× ×™×•×¦×’×• ×›××Ÿ..."></textarea>
        </div>
    </div>

    <script>
        // ×™×™×¦×•× ×§×•×¨×¡×™× ×œ×§×•×‘×¥ JSON
        function exportCourses() {
            try {
                // ×§×¨× ××ª ×›×œ ×”× ×ª×•× ×™× ×-localStorage
                const courses = localStorage.getItem('courses');

                if (!courses || courses === '[]') {
                    alert('âŒ ×œ× × ××¦××• ×§×•×¨×¡×™× ×œ×™×™×¦×•×');
                    return;
                }

                // ×¦×•×¨ ××•×‘×™×™×§×˜ ×’×™×‘×•×™ ×¢× timestamp
                const backup = {
                    version: '1.0',
                    timestamp: new Date().toISOString(),
                    courses: JSON.parse(courses)
                };

                // ×”××¨ ×œ-JSON
                const dataStr = JSON.stringify(backup, null, 2);
                const dataBlob = new Blob([dataStr], { type: 'application/json' });

                // ×¦×•×¨ ×§×™×©×•×¨ ×œ×”×•×¨×“×”
                const url = URL.createObjectURL(dataBlob);
                const link = document.createElement('a');
                link.href = url;

                // ×©× ×”×§×•×‘×¥ ×¢× ×ª××¨×™×š
                const date = new Date().toISOString().split('T')[0];
                link.download = `btk-courses-backup-${date}.json`;

                // ×”×•×¨×“
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                URL.revokeObjectURL(url);

                // ×”×¦×’ ×”×•×“×¢×ª ×”×¦×œ×—×”
                const successMsg = document.getElementById('exportSuccess');
                successMsg.style.display = 'block';
                setTimeout(() => {
                    successMsg.style.display = 'none';
                }, 3000);

                console.log('âœ… ×”×§×•×¨×¡×™× ×™×•×¦××• ×‘×”×¦×œ×—×”');
            } catch (error) {
                alert('âŒ ×©×’×™××” ×‘×™×™×¦×•×: ' + error.message);
                console.error('Export error:', error);
            }
        }

        // ×™×™×‘×•× ×§×•×¨×¡×™× ××§×•×‘×¥ JSON
        function importCourses(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const backup = JSON.parse(e.target.result);

                    // ×‘×“×™×§×•×ª ×ª×§×™× ×•×ª
                    if (!backup.courses || !Array.isArray(backup.courses)) {
                        throw new Error('×¤×•×¨××˜ ×§×•×‘×¥ ×œ× ×ª×§×™×Ÿ');
                    }

                    // ×©××œ ××™×©×•×¨
                    const confirmMsg = `×”×× ××ª×” ×‘×˜×•×— ×©×‘×¨×¦×•× ×š ×œ×©×—×–×¨ ${backup.courses.length} ×§×•×¨×¡×™×?\n\n` +
                                      `×ª××¨×™×š ×”×’×™×‘×•×™: ${new Date(backup.timestamp).toLocaleString('he-IL')}\n\n` +
                                      `âš ï¸ ×¤×¢×•×œ×” ×–×• ×ª×“×¨×•×¡ ××ª ×›×œ ×”×§×•×¨×¡×™× ×”×§×™×™××™×!`;

                    if (!confirm(confirmMsg)) {
                        return;
                    }

                    // ×©××•×¨ ×‘-localStorage
                    localStorage.setItem('courses', JSON.stringify(backup.courses));

                    // ×”×¦×’ ×”×•×“×¢×ª ×”×¦×œ×—×”
                    const successMsg = document.getElementById('importSuccess');
                    successMsg.textContent = `âœ… ${backup.courses.length} ×§×•×¨×¡×™× ×©×•×—×–×¨×• ×‘×”×¦×œ×—×”!`;
                    successMsg.style.display = 'block';

                    setTimeout(() => {
                        successMsg.style.display = 'none';
                    }, 5000);

                    console.log('âœ… ×”×§×•×¨×¡×™× ×©×•×—×–×¨×• ×‘×”×¦×œ×—×”');
                } catch (error) {
                    alert('âŒ ×©×’×™××” ×‘×™×™×‘×•×: ' + error.message);
                    console.error('Import error:', error);
                }
            };
            reader.readAsText(file);
        }

        // ×¦×¤×™×™×” ×‘× ×ª×•× ×™×
        function viewData() {
            try {
                const courses = localStorage.getItem('courses');
                const parsed = courses ? JSON.parse(courses) : [];

                const dataView = document.getElementById('dataView');
                dataView.value = JSON.stringify(parsed, null, 2);

                console.log('× ××¦××•', parsed.length, '×§×•×¨×¡×™×');
            } catch (error) {
                alert('âŒ ×©×’×™××” ×‘×§×¨×™××ª × ×ª×•× ×™×: ' + error.message);
                console.error('View error:', error);
            }
        }
    </script>
</body>
</html>
